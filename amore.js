
// CONTENUTI DEI VARI GIORNI // 

const contents = [

  {
    day:" Mancano 24 giorni a Natale",
    dayMessage: `Ciao amore mio, come prima ‚Äúcasella‚Äù di questo calendario dell‚Äôavvento volevo fare un recap di tutto quello che abbiamo vissuto insieme.`,
    items: [
      {
        type:"text",
        data:`Quando sono partita per New York non avevo nessuna aspettativa, ero felice di star saltando scuola e di visitare una nuova citt√† ma mai mi sarei aspettata che dopo quel viaggio la mia vita non sarebbe pi√π stata come prima. Gi√† dopo pochi giorni passati insieme avevo capito che tutto sarebbe stato diverso al nostro ritorno, IO sarei stata diversa. 

        Tornati a Como, fin da subito abbiamo affrontato le prime difficolt√† e, come ti ho gi√† detto, ho sentito la paura di perderti: gi√† mi immaginavo vecchietta con il rimpianto di non aver potuto nemmeno provarci, non sapere cosa sarebbe potuto succedere. 

        I primi mesi li abbiamo passati sulla nostra panchina, i pomeriggi volavano tra silenzi e sguardi, le notti sempre a scriverci, senza che il sonno ci toccasse, e le mattine passate aspettando solo il momento di uscire da casa. 

        Poi √® arrivato il viaggio a Lourdes. Le 12 ore in bus, che abbiamo passato stretti stretti ma comodi. Quella settimana arrivavamo a sera distrutti ma, in ogni caso, non ci facevamo mancare le coccole. Quelle sono state le nostre prime notti insieme e, non solo le prime notti. Il giorno dopo ho provato ancora una volta la paura di perderti, pensavo ti fossi pentito e vederti lontano, quasi come se fossi schifato da me, mi ha preoccupato parecchio, ma fortunatamente la sera ci siamo chiariti e tutto √® passato. 

        Il sentimento ha continuato a crescere ogni giorno di pi√π, passando dal Natale, alla primavera, l‚Äô8 aprile, fino all‚Äôarrivo dell‚Äôestate. 
        
        Con l‚Äôestate √® arrivato Miami, forse il viaggio in cui ci siamo divertiti di pi√π, abbiamo passato una settimana appicciati. Alle cene ridevamo fino al male agli zigomi, vedendoci da fuori probabilmente avrei pensato fossimo pazzi ma avrei anche invidiato il nostro amore. Solo guardandoci traspare la purezza e la semplicit√† della nostra relazione, si vede che proviamo gioia con la compagnia dell‚Äôaltro, che basta sentirne il nome per far spuntare un sorriso. 
        Ovviamente √® arrivato il nostro anniversario, il nostro primo grande traguardo, ormai sto gi√† facendo il conto alla rovescia per il prossimo.

        Poi, di nuovo, l‚Äôinizio della scuola e l‚Äôarrivo di Dubai. Un viaggio molto desiderato ma che non ci ha soddisfatto a pieno. Noi siamo abituati a vivere in simbiosi, abbiamo bisogno di tempo soli per dire le nostre scemenze.

        Arriviamo poi ad oggi, tu rappresenti tutto per me. Sei la mia felicit√†, sei in grado di portare luce anche nella giornata pi√π buia, il mio primo pensiero in qualsiasi occasione, con te riesco ad essere sempre me stessa, sempre senza filtri. Non c‚Äô√® cosa pi√π bella di sapere che ho te al mio fianco e che in qualsiasi occasione posso contare su di te. 
        
        Oggi √® il primo giorno di questo calendario dell‚Äôavvento e spero che tutte le caselle ti trasmettano quando io ci tenga a te e sia grata di averti al mio fianco. 
       
        Ti amo. 
        Buona giornata 
        `
      }
    ]
  },

  {
    day:" Mancano 23 giorni a Natale",
    dayMessage: `Ammmooorreee siamo gi√† al secondo giorno, assurdo. Oggi vorrei ricordarti quanto io sia innamorata di te. `,
    items: [
      {
        type:"text",
        data:`Fin dal primo giorno in cui ci siamo conosciuti ho capito che quelle farfalle nello stomaco avevano un significato profondo. I sentimenti nei tuoi confronti sono emersi in pochissimo tempo e subito fortissimi, come se fossero sempre stati l√¨ ed aspettassero solamente il momento giusto per mostrarsi.
        
        Non so come descrivere bene quello che provo per te, non so trovare le parole che riescano a rendere veramente il significato dei miei sentimenti, sono talmente forti e talmente belli che servirebbe inventare un nuovo termine per rendere l‚Äôidea.
        
        Per usare un termine che conosciamo: io ti tutepatenja. Tu mi fai stare benissimo, con te mi sento a casa, al sicuro. Solo sapere della tua esistenza mi rassicura, mi fa sentire meglio. L‚Äôunica cosa che voglio quando sono gi√π di morale √® vederti: sei come l‚Äôarcobaleno dopo la pioggia, sei in grado di portare i colori nel mio buio. 
        
        Io ti vedo nel mio futuro: vedo TE e me mentre sistemiamo la spesa nella nostra casa, vedo TE e me in aeroporto partire per le vacanze, vedo TE e me comprare i vestitini e i giochini per i nostri bimbi, vedo TE e me che facciamo la doccia insieme dopo il lavoro, vedo TE e me spettegolare dei nostri figli la notte, vedo TE e me fare le coccole sul divano insieme ad Otto, vedo TE guardarmi con la luce negli occhi mentre mi avvicino all‚Äôaltare. 
        Vedo NOI. 
        Non mi immagino una vita senza la tua presenza, sarebbe sprecata perch√© l‚Äôunica cosa che mi fa stare bene in questo mondo sei tu. 
       
        Tu sei presente in tutti gli aspetti della mia vita e non potrei mai essere pi√π grata di questo. Io ti ringrazio infinitamente per essere come sei, per amarmi come sai fare e per essere sempre presente per me. Sei perfetto, sei la pausa nel mio caos, sei in grado di darmi pace. 
        
        Ti amo. 
        Buona giornata
        `
      }
    ]
  },

  {
    day:" Mancano 22 giorni a Natale",
    dayMessage: `Oggi hai una missione amore: devi completare il memory. Ti assicuro che √® pi√π facile dell‚ÄôUNO-memory :) `,
    items: [
      {
        type:"memory",
      }
    ]
  },

  {
    day:" Mancano 21 giorni a Natale",
    dayMessage: `Ciao amore mio. Per questa casella vorrei partire da una foto ma non preoccuparti che dalla prossime casella sarai messo un po' alla prova... `,
    items: [
      {
        type:"image",
        data: "Foto1.jpg",
        caption:`Vedi quel sorriso che ho stampato in faccia? 
        ecco, quello √® lo stesso che tu, come per magia, riesci a far spuntare ancora oggi. 
        Se sto piangendo da due ore so che mi basta passare 10, massimo 15, minuti con te per farmi passare tutto. 

        Il desiderio di quella bambina era di trovare il suo principe azzurro, cos√¨ come hanno fatto tutte le principesse sulla palla con cui giocava, voleva l‚Äôamore della Disney. Ora le vorrei dire che l‚Äôamore che ha trovato √® ancora meglio di quello delle favole. 
        Tu sei tutto per me amore, sei il mio pilastro, il mio punto fermo, so che di te mi posso fidare. Mi fai tornare bambina, con te mi sento al sicuro, protetta da tutto quello che mi potrebbe ferire.  `
      }
    ]
  },

  {
    day:" Mancano 20 giorni a Natale",
    dayMessage: `Amore oggi sei sotto esame eh. Mi raccomando pensaci bene prima di rispondere. Ti spiego un paio di regole, dopo averle lette attentamente puoi iniziare: 
    1.	quando rispondi non puoi pi√π modificare la risposta 
    2.	non vale chiedere suggerimenti alla desa
    3.	non vale chiedere suggerimenti a chat 
    4.	ti amo
     `,
    items: [
      {
        type: "quiz",
        question: "Quando siamo usciti per la prima volta solo io e te a Como?",
        options: ["8 maggio", "9 maggio", "15 maggio", "8 giugno"],
        correct: 1
      },
      {
        type: "quiz",
        question: "Qual √® stato il primo film di animazione che abbiamo visto insieme?",
        options: ["Lilo & Stitch", "Grinch", "Gli Aristogatti", "Cattivissimo Me 4"],
        correct: 2
      },
      {
        type: "quiz",
        question: "Secondo te, qual √® la mia principessa Disney preferita?",
        options: ["Cenerentola", "Rapunzel", "Aurora", "Biancaneve"],
        correct: 0
      }, 
      {
        type: "quiz",
        question: "come avremmo voluto chiamare la desa se non desa?",
        options: ["Luna", "Cookie", "Sophie", "Marley"],
        correct: 2
      },
      {
        type: "quiz",
        question: "In che argomento ho preso l'unica insufficienza in matematica?",
        options: ["Esponenziali", "Geometria nello spazio", "disequazioni fratte", "Radicali"],
        correct: 3
      },
      {
        type: "quiz",
        question: "A che ora era il volo per New York?",
        options: ["all 16", "alle 17:30", "Alle 12", "alle 20"],
        correct: 3
      },
      {
        type: "quiz",
        question: "A che liceo ero iscritta prima di cambiare per il Gallio?",
        options: ["Volta", "Giovio", "Setificio", "Canossiane"],
        correct: 0
      },
      {
        type: "quiz",
        question: "che animale sceglierei tra questi:",
        options: ["Marmotta", "gatto", "papera", "anatra"],
        correct: 2
      },
      {
        type: "quiz",
        question: "Quanto ti amo?",
        options: ["tanto", "tantissimo", "ottantissimo", "ottantissimisimissimo"],
        correct: 3
      }, 
      {
        type: "quiz",
        question: "a che animale dobbiamo aprire un profilo ig?",
        options: ["gatto nano e pelosissimo", "una lince", "un delfino", "un papapgallo"],
        correct: 1
      }
    ]
  },

  {
    day:" Mancano 19 giorni a Natale",
    dayMessage: `Buongiorno amore miooo, spero che tu stia bene. Oggi volevo ricordarti che io ci sono sempre per te! `,
    items: [
      {
        type:"text",
        data:`Spero che le cose che sto scrivendo via via nelle caselle possano, in qualche modo, migliorarti le giornate e sentirmi pi√π vicina anche se non ci riusciamo a vedere tutti i giorni. 

        Voglio che tu sappia che ci sono sempre per te, voglio essere presente nella tua vita, sia nelle cose belle che in quelle un po‚Äô meno belle, perch√© voglio farti da spalla, voglio che tu ti senta al sicuro con me e che ti possa fidare ciecamente.
        Secondo me, la nostra relazione pu√≤ essere invidiata da molti, sia perch√© chiaramente siamo bellissimi insieme, ma soprattutto perch√© traspare l‚Äôaffetto che proviamo l‚Äôuno nei confronti dell‚Äôaltro. Dopo aver passato un anno praticamente in simbiosi non ci siamo stancati, anzi pi√π passa pi√π ne sento il bisogno. 

        Quando sono con te rido e mi comporto come una matta: non mi sarei mai immaginata di aprirmi cos√¨ tanto da scoprire, io stessa, delle nuove parti di me che non avevo mai osservato. 

        Un esempio e sicuramente il contatto fisico, che ero convinta di odiare. Anche un abbraccio mi provocava disagio e imbarazzo e per questo mi definivano ‚Äúapatica‚Äù o fredda ma con te ho scoperto che non √® cos√¨. Semplicemente non avevo trovato una persona che mi facesse sentire cos√¨ a mio agio. Ora sogno di abbracciarti, quando vado a dormire penso sempre a come ci incastriamo bene l‚Äôuna nelle braccia dell‚Äôaltro. 

        Un‚Äôaltra cosa √® la dolcezza, credevo di non essere capace di mostrarmi ‚Äúvulnerabile‚Äù sotto quel punto di vista ma con te √® stato tutto cos√¨ automatico che non ci ho mai fatto caso. Ho sempre avuto una barriera e ancora oggi faccio fatica a dire ‚Äúti voglio bene‚Äù: che sia a Martina, mia mamma o mio fratello, io non lo dico mai. L‚Äôunica persona (anche ora) che √® riuscita a superare questo muro invisibile sei stato tu e mi hai fatto scoprire come sia liberatorio. 
        
        Grazie mille amore mio. Ti amo tanto. 
        Buona giornata `
      }
    ]
  },

  {
    day:" Mancano 18 giorni a Natale",
    dayMessage: `Amore oggi ti devi completare un bel puzzle. Spero non sia troppo facile per te che sei bravissimo ü§©`,
    items: [
        {
          type: "puzzle",
          data: "Puzzle.JPG",
          rows: 8,
          cols: 8,
          pieceSize: 80
        }
    ]
  },

  {
    day:" Mancano 17 giorni a Natale",
    dayMessage: `Oggi direi che √® importante iniziare dicendoti: BUON OTTOOOO AMMMOOORRREEEE MMMIIIIOOOOO!!!!!!!!!! `,
    items: [
      {
        type:"text",
        data:`Il modo migliore per iniziare una giornata √® sapere che √® il nostro mesiversario (nonostante il mese scorso ce ne fossimo dimenticati).

        Io credo fermamente che non sia stato un caso conoscerci proprio l'8 ma, anzi, sia stato un modo per dire "starete insieme per sempre". Mi sono informata sui diversi significati di questo bel numero e ora te ne voglio elencare qualcuno. 

        1) significato metafisico: il numero OTTO rappresenta l'armonia perfetta tra il cielo e la Terra, il successo materiale ottenuto tramite equilibrio spirituale e giustizia.

        2) significato simbolico: numero associato alla capacit√† di superare le sfide e raggiungere l'equilibrio attraverso la resilienza e la trasformazione. La sua forza i richiama coraggio, determinazione e la capacit√† di rialzarsi dopo ogni caduta. √à anche un numero di equilibrio dinamico: come il flusso dell‚Äôinfinito, bilancia le forze opposte e guida verso l‚Äôauto-realizzazione e l‚Äôintegrazione dei contrasti della vita.

        3) significato mitologico: Nella mitologia e negli archetipi universali, l‚Äô8 √® legato alla rinascita, al rinnovamento e alla trasformazione ciclica. Compare spesso come simbolo di resurrezione e rigenerazione, collegando la fine di un ciclo all‚Äôinizio di uno nuovo. In molte culture, √® il numero che simboleggia l‚Äôabbondanza divina, la fortuna e la continuit√† della vita, spesso associato a divinit√† della prosperit√† e della rigenerazione.

        4) Geometria: la sua geometria rivela la connessione con l'infinito e l'eterno. In geometria sacra, l‚Äô8 √® considerato un numero armonico: bilancia proporzioni e cicli, evocando l‚Äôidea di un equilibrio universale che trascende il tempo. √à anche simbolo di simmetria e perfezione, evocando stabilit√† e continuit√†.
       
        "L‚Äô8 √® nodo d‚ÄôAmore, vincolo, canale, collante che tiene insieme tutti gli enti. Solo l‚ÄôAmore dunque √® il linguaggio perfetto che riesce a compiere il miracolo di porre di fronte l‚Äôuno all‚Äôaltro: i due volti, quello del Macrocosmo e quello del microcosmo, quello Divino e quello umano, riconnettendo l‚Äôiniziato alla sorgente del tutto."     
        
        Penso che tutto questo non sia scontato. Un numero cos√¨, che racchiude in s√© tanti significati cos√¨ belli, non pu√≤ che significare una cosa. 
        La nostra relazione mostra gi√† un p√≤ di tutti questi valori: banalmente l'armonia, non ci √® mai successo di litigare o scontrarci. 
        
        Sai che cos'altro √® infinito? l'amore che provo nei tuoi confronti. Il sentimento che io provo per te √® interminabile, non ha fondo e fine, nulla pu√≤ essere paragonato a quello, se anche contassi tutti i granelli di sabbia presenti in questo mondo non riusciresti a raggiungere quanto io ti amo. 
        Tu per me sei tutto, spero di riuscire a dimostrarlo almeno un po'. 
        
        Ancora buon quindicesimo mesiversario Amore. Ti amo.
        Buona giornata.
         `
      }
    ]
  },

  {
    day:" Mancano 16 giorni a Natale",
    dayMessage: `Buongiorno amore mio, Oggi volevo farti vedere questa foto, ormai ne abbiamo tante insieme ma qui √® dove tutto √® partito...`,
    items: [
      {
        type:"image",
        data: "Prima_foto.JPG",
        caption:`Guardando questa foto mi salgono in mente molti ricordi amore, spero sia lo stesso anche per te. 
        La nostra PRIMA foto insieme (ovviamente oltre a quelle paparazzate). Prima volta in cui incontravo qualcuno della tua famiglia. 

        Ero molto in ansia prima di quella nostra uscita, perch√© non sapevo cosa aspettarmi e avevo paura di non piacere e risultare non alla tua altezza. 
        Se devo dire la verit√† ero in ansia sempre prima di vederti, avevo sempre paura di poter fare qualcosa di male, che non ti sarebbe piaciuto e che non mi rivolgessi pi√π la parola. 

        Nella mia testa sei sempre stato troppo perfetto per stare con me, volevo sempre essere nelle migliori condizioni possibili per evitare che potessi notare i miei difetti e poi scappare via. Ero terrorizzata dall‚Äôidea che ti saresti potuto accorgere che non fossi al tuo pari, quindi mi avresti ‚Äúmollato‚Äù. Per fortuna non √® successo altrimenti sarei ancora in cura per depressione.  
        
        Ti amo amore mio. Grazie mille. 
        Buona giornata!
        `
      },
    ]
  },

  {
    day:" Mancano 15 giorni a Natale",
    dayMessage: `amore, oggi devi farmi vedere se sei capace di completare il cruciverba e se ha veramente assimilato alcune delle parole del nostro linguaggio segreto‚Ä¶ `,
    items: [
        {
          type: "crossword",
              data: "" 
  
        }
    ]
  },

  {
    day:" Mancano 14 giorni a Natale",
    dayMessage: `Buongiorno amore mio. Se dovessi pensare a tutte le cose che abbiamo passato insieme quale sarebbe la prima che ti salterebbe in mente? (rispondimi su whatsapp) `,
    items: [
      {
        type:"text",
        data:`Nel mio caso ammetto di vedere tante tante cose.

        La prima fra tutte √® l‚Äôimmagine di me e te a Miami: noi che ci mettiamo la crema a vicenda, le risate a tavola, le passeggiate serali, altre cose sempre serali, lo shopping, la camminata sul tronco insieme e tante altre. Queste sono le prime immagini che mi riempiono il cuore. 
        
        Ci sono tanti altri momenti della nostra relazione che saranno sempre presenti nella mia mente.
        Un √® sicuramente San Valentino, quando ci siamo seduti su una panchina gelida e tenendoci per mano ti ho letto tutti quei punti della lista, con la voce che tremava e gli occhi che si riempivano di lacrime non facendomi vedere bene. Questo non te l‚Äôho mai detto: avevo paura che non ti piacesse e rimanessi deluso, anche per il fatto che non avessi ancora fatto il barattolo; infatti, ho aspettato un po‚Äô prima di dirtelo, e solo a cena guardandoti negli occhi sono riuscita a prendere coraggio.

        Poi come dimenticare tutti i nostri primi sguardi e le prime carezze. Ce ne sarebbero molti altri perch√© tutti i momenti che passiamo insieme sono indimenticabili, grazie a te che sei speciale amore. Voglio sapere quali sarebbero per te mi raccomando ricordati 
       
        Ti amo amore. 
        Buona giornata.
        `
      }
    ]
  },

  {
    day:" Mancano 13 giorni a Natale",
    dayMessage: `Buongiorno amore mio. Spero che tu stia bene. Oggi ti aspetta un giochino semplice... `,
    items: [
        {
          type:"wordsearch",
          words:["AMORE","DESA","NATALE", "NEWYORK", "RROVVII"],
          message:"Bravissimo amore mio bello! Sei riuscito a trovare tutte le paroline! Ti amooo"
        }
    ]
  },



  {
    day:" Mancano 12 giorni a Natale",
    dayMessage: `Buongiono amore mio. Anche oggi vorrei partire da una foto che mi piace molto per l'idea che mi trasmette...`,
    items: [
      {
        type:"image",
        data: "Dubai.JPG",
        caption:`Questa foto mi piace tanto perch√© √® come se dicesse ‚Äúnoi due contro il mondo‚Äù. 
        Guardandola mi viene in mente questo: noi due che, nonostante tutte le perturbazioni esterne, tutti gli avvenimenti, belli o brutti che siano, saremo sempre noi due. Sempre io e te che ci teniamo la mano, ci asciughiamo le lacrime a vicenda e ci sproniamo ad andare avanti, come abbiamo sempre fatto fino ad ora. 

        Qualche ostacolo lo abbiamo gi√† sorpassato ma abbiamo ancora tutta la vita davanti e sicuramente ne dovremmo affrontare altri ma so che saremo in grado di farlo. Sempre a testa alta, sempre tenendoci la mano perch√© l‚Äôamore √® la chiave per superare ogni cosa, e io di amore per te ne provo davvero tanto tanto tanto. 

        Saremo in grado di andare avanti sempre insieme, perch√© in te ho trovato una spalla su cui appoggiarmi quando penso di non riuscire e poi alla fine ce l‚Äôho fatta, grazie al tuo aiuto. 
        
        Grazie amore mio. Ti amo tanto tanto. 
        Buona giornata amore.          
        `
      },
    ]
  },

  {
    day:" Mancano 11 giorni a Natale",
    dayMessage: "Amore oggi giochino particolare... Ho scelto un piccolo estratto dai nostri 2.08GB (lo scrivi tu) di memoria su whatsapp e tu dovrai scegliere, tra le opzioni che ti ho messo, come continua la chat. Buona giornata amore  ",
    items: [
        {
          type: "chatGuess",
          data: "Chat.PNG",
          answers: [
            "‚ôæÔ∏è8",
            "888",
            "10",
            "888888888888888888888888"   
          ],
          correct: 3 
        }
    ]
  },

  {
    day:" Mancano 10 giorni a Natale",
    dayMessage:`Buongiono amore mio. Oggi hai in mano una scelta importante. Il gioco di oggi lo definirei un gratta e vinci, quindi devi scegliere 3 tra i cerchi e grattare via la patina, le tre attivit√† che compariranno le faremo la prossima volta che ci vediamo. Scelgi bene amore mio, non so se tutte ti piaceranno... `,
    items: [
        {
          type: "scratchcard",
        }
    ]
  },

  {
    day:" Mancano 9 giorni a Natale",
    dayMessage: `Buongiorno amore mio. In questo momento (quello in cui sto pensando al messagio di oggi) mi sono chiesta una cosa: chiss√† che relazione c'√® tra i nostri segni zodiacali? vediamlo... `,
    items: [
      {
        type:"text",
        data:`Penso che ormai tu sappia che non sono una che crede molto in queste cose PER√í sarebbe comunque una coincidenza molto bella. 

        La prima frase che esce quando cerchi dice: ‚Äúil rapporto amoroso tra leone e bilancia risulta ben equilibrato‚Äù. Gi√† direi che ci ha azzeccato, tra me e te c‚Äô√® piu che un equilibrio, siamo quasi la stessa persona, abbiamo le stesse abitudini, gli stessi pensieri, gli stessi valori e condividiamo la maggior parte delle attivit√† insieme. 

        ‚ÄúI due segni si trovano in posizioni opposte nello schema dello Zodiaco e questo permette loro di avere una maggiore capacit√† di comunicazione e comprensione dei diversi punti di vista‚Äù. Anche questo √® giusto, siamo sempre aperti l‚Äôuno con l‚Äôaltra e le cose ce le diciamo sempre, non mi sembra che ci siano dei ‚Äúnon detti‚Äù, io con te condivido ogni minimo pensiero. 
        
        ‚ÄúLa coppia √® caratterizzata da un equilibrio interno molto stabile dovuto alla combinazione della forza del leone e l‚Äôarmonia della bilancia. Il rapporto √® molto intenso a causa della totale devozione l‚Äôun l‚Äôaltro: la bilancia trasmette calma e tranquillit√† al partner, al contrario, il leone spinge l‚Äôaltro a essere pi√π disinvolto e spontaneo nella presa di decisioni‚Äù. Anche questo √® verissimo, o almeno da parte mia. Da quando sto con te sono pi√π espansiva, perch√© mi doni serenit√† e sapere che una persona speciale come te mi ama mi rende pi√π sicura sotto ogni punto di vista. 
        
        ‚ÄúIl leone subisce l‚Äôinfluenza del sole mentre la bilancia di venere, i pianeti della passione e dell‚Äôamore, creando in armonia in grado di dar vita ad una relazione duratura‚Äù. Direi che in entrambe le cose, la passione e l‚Äôamore, siamo messi bene no? Non ci manca nulla. 
        
        Sar√† un caso che qualsiasi cosa ci riguardi abbia un significato simile? Io non penso, tutto l‚Äôuniverso sa che siamo destinati a durare ed amarci sempre, oltre ogni ostacolo. 
        
        Ti amo amore. 
        Buona giornata. 
         
        `
      }
    ]
  },

  {
    day:" Mancano 8 giorni a Natale",
    dayMessage: `Buongiono amore mio. Oggi ricordiamo il nostro decimo mesiversario... Hi gi√† capito di che cosa parlo?`,
    items: [
      {
        type:"image",
        data: "Terme.jpg",
        caption:` Eccoci qui, belli come sempre ma rilassati come poche volte. Quel giorno √® stato proprio all'insegna del relax. Io e te, nelle saune, nel bagno turco, con le bolle, la musica nell'acqua e tante altre cose. 
        Non sono cos√¨ tanto rilassata da quel giorno penso. Nonostante ogni volta che ci vediamo io mi riesca a scaricare dalla tensione accumulata per tutti quei giorni in cui non abbiamo avuto la possibilit√† di stare insieme.
        
        Con te mi riesco a sfogare amore, anche solo un un abbraccio. anche le mie scariche di iperattivit√† sono un modo per sfogarmi e so che con te posso lasciarmi andare perch√® non mi giudichi ma, anzi, inizi anche tu a sfogarti con me. Poi ci ritroviamo sul letto a baciarci con il fiatone.
        Io ti voglio ringraziare anche per questi momenti di pace e serenit√† che sei in grado di offrirmi ogni giorno. 

        Ti amo amore mio. Sei la mia vita.
        Buona giornata.
        `
      },
    ]
  },

  {
    day:" Mancano 7 giorni a Natale",
    dayMessage: `Buongiorno amore mio. Quello di oggi √® stato uno dei giochi pi√π lunghi da fare, ho pensato di abbandonare pi√π e pi√π volte ma, fortunatamente, proprio quando stavo per gettare la spugna ci sono riuscita. 
    Devi collegare i puntini seguendo un.ordine crescente e quando avrai completato tutto comparir√† la foto...(scusami se non dovessere essere perfetto)`,
    items: [
        {
          type: "connectDots",
          data: "Punti.jpeg"
        }
    ]
  },

  {
    day:" Mancano 6 giorni a Natale",
    dayMessage: `Buongiorno amore mio, anche quello di oggi √® stato abbastanza lungo da preparare.
    Tu sai che io avevo un'ossesione nel trovare le differenze quindi non poteva mancare anche in questo calendario. 
    Oggi vedrai due foto, una intorna com'√® stata scattata mentre l'altra l'ho modificata io e tu dovrai trovare le differenze. 
    Mi raccomando devi selezionrle sulla prima foto altrimenti non te le segna corrette. 
    Ti amo. Buona giornata. `,
    items: [
      {
        type: "diff",
        img1: "Giusta.jpeg",
        img2: "Differenze.JPEG",
        differences: [
            { x: 187, y: 27 , r: 24 },
            { x: 76.5, y: 303.5, r: 14.5 },
            { x: 118, y: 156, r: 15 },
            { x: 90, y: 226 , r: 23 },
            { x: 0, y: 215, r: 27 }
        ]
      }
    ]
  }, 
  {
    day:" Mancano 5 giorni a Natale",
    dayMessage:`Buongiorno amore mio. Ormai siamo agli sgoccioli quindi direi che √® arrivato il momento di illustrarti tutte le difficolt√† che ho incontrato nel farti questo picolo pensierino...`,
    items: [
        {
          type:"text",
          data:`Mancano solo cinque giorni poi avrai ‚Äúaperto‚Äù tutto il calendario dell‚Äôavvento. 
          Mi sono impegnata tantissimo per cercare di renderlo il pi√π bello possibile e cercare di non ripetere troppe volte le stesse cose. 

          Pensare a tutti i giochini, le foto da mettere, le parole, le scritte, il touch, le immagini e le didascalie posizionate come volevo io, trovare il font giusto, i colori che stessero bene e far in modo che tutto funzionasse √® stata un‚Äôimpresa. Devo ammettere di aver anche un po‚Äô sottovalutato il tutto, ovviamente ero consapevole che sarebbe stato abbastanza complicato ma non pensavo cos√¨ tanto‚Ä¶
          
          Pensa che ne parlai anche con il Turrini, facendogli un po‚Äô vedere la mia idea e lui mi disse ‚Äúah cavolo gli vuoi proprio bene a questo ragazzo!‚Äù e io tra me e me pensai ‚Äúdai non √® mica cos√¨ complicato‚Äù. Ecco cara Laura, si che √® complicato, c‚Äô√® un motivo se vengono pagati tanto quelli che fanno i siti. Per√≤ fa niente, lo rifarei assolutamente magri per√≤ lo sottovaluterei un po‚Äô meno. 
          
          Oggi, che sto scrivendo questo testo, √® il 30 novembre: avrei ancora 7 pagine di italiano da studiare ma per me √® pi√π importante finire questo calendario. Voglio che sia perfetto, come me lo sono immaginato, e che tutto quello che ho fatto fino ad ora non venga buttato al vento per qualche dimenticanza. Sono fiera di come stia venendo e di tutto l'impegno che ci sto mettendo. 
         
          Spero che ti stia piacendo amore. Aspetto il 25 dicembre per le tue considerazioni finali. 
          Ti amo amore mio. 
          Buona giornata.`
  
        }
    ]
  },

  {
    day:" Mancano 4 giorni a Natale",
    dayMessage: `Buongiorno amore. Il Natale si sta avvicinando sempre di pi√π, direi che √® arrivato il momento di decorare l'albero... `,
    items: [
        {
          type: "christmasTree",   
        treeImage: "PinoII.avif",
        balls: [
          "AereoMiami.JPG","Appendini.JPG","Sottoacqua.JPG","Terme.jpg","üóΩ","Maschere.JPG","AereoMiami.JPG","Compleanno.JPG","Papera.JPG","Piedi.jpg","tiamo.jpeg"
        ],
        bowContent: ["üéÄ","üéÄ","üéÄ"],
        message: "Bravissimo amore mio... Hai fatto il nostro albero di natale "
  
        }
    ]
  },

  {
    day:" Mancano 3 giorni a Natale",
    dayMessage: `Buongiorno amore mio. Ormai stiamo arrivando alla fine ma non ho ancora trattato nel dettaglio il mio argomento preferito... New York. Direi che √® arrivato il momento, che ne dici?`,
    items: [
      {
        type:"image",
        data: "Ny1.JPG",
        caption:`Mi piace parlarne perch√© per me √® la citt√† dell‚Äôamore e io amo l‚Äôamore, anzi mi correggo: io amo l‚Äôamore che provo per te. 

        Tutto √® partito da l√¨: quei palazzi hanno guardato il nostro sentimento nascere, hanno visto i nostri sguardi, hanno avuto il posto in prima fila per i nostri primi abbracci, le prime mani intrecciate, le nostre prime timide risate. Loro sono stati spettatori di questa magia e si meriterebbero di essere nostri testimoni di nozze. (mi sto commuovendo mentre scrivo queste cose) 
        
        NY, una citt√† cos√¨ frenetica, la citt√† che non dorme mai ma che allo stesso tempo √® cos√¨ armoniosa, ogni rumore trova il suo spazio e lo rende melodico. Ed √® proprio in quella confusione che anche io sono riuscita a trovare il posto giusto: le tue braccia. 
        
        Sei riuscito ad entrare nel mio cuore senza chiedermi il permesso, so che pu√≤ sembrare una frase fatta ma √® quella che lo rappresenta a pieno. Fin dall‚Äôinizio l‚Äôhai riempito di gioia, di affetto e l‚Äôhai fatto rinascere. Ora segue il battito del tuo cos√¨ come il mio respiro si adegua al tuo quando siamo abbracciati. 
        
        Io ti cerco costantemente, da tutte le parti. Vorrei vedere la tua faccia nelle foglie degli alberi, nelle gocce di pioggia, nei chicchi di caff√® e riflessa sul cucchiaio con cui faccio colazione ma purtroppo non √® cos√¨. Le mie giornate sono sempre alla ricerca di te, anche quando non i vediamo il mio scopo √® quello di liberarmi il pi√π possibile per riuscire a vederti. 
        
        Non ci sarebbe stato un posto migliore per l‚Äôinizio della nostra storia, ha reso ancora pi√π magica l‚Äôintera atmosfera.
        
        Ti amo da morire amore. Sei la mia felicit√†. 
        Buona giornata.        
        `
      },
    ]
  },

  {
    day:" Mancano 2 giorni a Natale",
    dayMessage: `Buongionro amore mio. Oggi giorno particolare, devi riuscira a raggiungere i 400 punti. Tira la leva e dedrai...`,
    items: [
        {
          type: "slotmachine"
  
        }
    ]
  },

  {
    day:" Manca 1 giorni a Natale",
    dayMessage:`Buona vigilia amore mio. Oggi √® il penultimo giorno di questo calendario ed √® uno di quelli che mi ha fatto piangere di pi√π mentre lo scrivevo...`,
    items: [
        {
          type:"text",
          data:`In occasione di questa giornata speciale volevo parlarti di una canzone.
          
          Non √® un argomento che trattiamo spesso ma volevo che sapessi qual √® la mia canzone preferita. 
          Ogni volta che l'ascolto mi fa venire i brividi e quasi commuovere, √® una canzone che mi colpisce il cuoricino in pieno. Sto parlando di "La cura‚Äù di Battiato. 

          Ogni parola la sento come se fosse amplificata. Quando la ascoltavo mi chiedevo sempre "chiss√† che sentimento si prova per dedicare queste parole ad una persona‚Äù e ora ho capito, ora lo so. 
         
          Ora che la riascolto mi si accende qualcosa di nuovo nell‚Äôanima. La canzone parla di un amore che fa crescere, che ti accompagna nella vita, che ti protegge ma allo stesso tempo ti lascia libero. √à una promessa di un amore che guarisce senza pretendere nulla in cambio. 
          
          L‚Äôamore di cui parla lui √® quello che ti conosce pi√π di quanto tu conosca te stesso: conosce il tuo buio, tutto quello che vuoi nascondere, le pi√π piccole insicurezze. E di fronte a tutto questo, non scappa via, anzi il contrario, promette la cura, l‚Äôattenzione di quei particolari.
          
          L‚Äôamore vero non ti vuole cambiare ma ti accetta per come sei. Proprio come hai fatto tu: mi hai accettato per come sono e per come ero. Io mentre ascolto questa canzone penso a te e voglio che tu sappia che quelle parole, quelle promesse, hanno un significato per me. Io voglio starti accanto sempre e fare ogni cosa per non farti soffrire, per proteggerti perch√© tu sarai sempre il mio piccolino, il mio bimbo. 
          
          Io "superer√≤ le correnti gravitazionali‚Äù per te amore. Voglio che per te sia chiaro che non c'√® nulla che non farei pur di starti accanto, anche le sfide pi√π difficili non basteranno per allontanarmi da te. 
         
          Quella canzone ora trova significato e quello sei tu. 
          Ti amo amore mio. 
          Buona vigilia. 
          `
  
        }
    ]
  },

  {
    day:"BUONA NATALE AMORE MIO!!!!",
    dayMessage:`Buon Natale amore mio bello. Spero che questa giornata possa essere per te piena di gioia, di affetto e di serenit√†.`,
    items: [
        {
          type:"text",
          data:`Ormai siamo giunti alla fine di questo calendario: spero davvero che ti sia piaciuto e che in qualche modo ti abbai fatto sentire il mio affetto e la mia vicinanza. 
          Ogni giorno ho cercato di renderlo il pi√π personale possibile: partendo dalla scelta dello sfondo, delle foto, dei colori, delle frasi, dei giochi, delle emoji. 
          
          Ho cercato di fare del mio meglio partendo dalle mie capacit√†. √à stato complicato ma spero ne sia valsa la pena, spero che tu abbia apprezzato questo mio piccolo sforzo. 
          
          Ora √® arrivato il Natale, quando ti sto scrivendo non so ancora quale sar√† il tuo regalo di Natale e anche se non lo sapessi non te lo direi ora üòõ. Spero che tu stia passando delle belle feste, che ti stia divertendo, che le stia passando con la tua famiglia e spero anche con me, perch√© per me sei tu la mia famiglia. Per me, come ti ho gi√† detto in questi giorni, tu sei il mio futuro. 
          
          Ora tu lascio festeggiare in pace amore mio. Ti auguro ancora un Buon Natale. 
          (poi fammi la recensione finale eh, dimmi sinceramente quello che pensi)
          
          Ti amo da morire amore mio.           
          `
        }
    ]
  },
];

// -------------------- CONFIGURAZIONE PROGRAMMA --------------------

// -------------------- DATE E GIORNO ATTUALE --------------------
const startDate = new Date(2025, 11, 1); // inizio calendario
const christmasDate = new Date(2025, 11, 25); // Natale
const today = new Date();
let diffDays = Math.floor((today-startDate)/(1000*60*60*24));
diffDays = Math.max(0, Math.min(contents.length-1, diffDays));

const contentEl = document.getElementById("content");
const debugMode = true;
let currentDay = diffDays;

// ---------------FUOCHI D'ARTIFICIO ------------------
function createFireworksOverlay() {
  const overlay = document.createElement("canvas");
  overlay.id = "fireworksCanvas";
  overlay.style.position = "fixed";
  overlay.style.top = "0";
  overlay.style.left = "0";
  overlay.style.width = "100vw";
  overlay.style.height = "100vh";
  overlay.style.pointerEvents = "none";
  overlay.style.zIndex = "9999";

  document.body.appendChild(overlay);
  return overlay;
}
let fireworksCanvas = null;

// -------------------- FUNZIONE TYPEWRITER --------------------
function typeWriter(element, text, speed=35){
  element.textContent="";
  let i=0;
  function addChar(){
    if(i<text.length){
      element.textContent+=text.charAt(i);
      i++;
      setTimeout(addChar,speed);
    }
  }
  addChar();
}

// -------------------- MEMORY GAME --------------------
function createMemoryGame(dayIdx) {
  const wrapper = document.createElement("div");
  wrapper.classList.add("memory-game");

  const images = [
    "desa.JPG",
    "18.JPG",
    "maschere.JPG",
    "papera.JPG",
    "piedi.jpg"
  ];

  let deck = images.concat(images).sort(() => 0.5 - Math.random());

  const grid = document.createElement("div");
  grid.classList.add("memory-grid");
  wrapper.appendChild(grid);

  let firstCard = null;
  let secondCard = null;
  let lockBoard = false;
  let matches = 0;
  const totalMatches = images.length;

  function resetBoard() {
    firstCard = null;
    secondCard = null;
    lockBoard = false;
  }

  deck.forEach(imgSrc => {
    const card = document.createElement("div");
    card.classList.add("memory-card");
    card.dataset.image = imgSrc;
    card.dataset.matched = "false";

    const front = document.createElement("div");
    front.classList.add("front");
    front.style.backgroundImage = `url(${imgSrc})`;

    const back = document.createElement("div");
    back.classList.add("back");
    back.style.backgroundImage = "url('Bassotti_memory.jpg')";
    back.style.backgroundSize = "cover";
    back.style.backgroundPosition = "center";
    back.textContent = ""; 

    card.appendChild(front);
    card.appendChild(back);

    card.addEventListener("click", () => {
      if (lockBoard) return;
      if (card.dataset.matched === "true") return;
      if (card === firstCard) return;

      // gira la carta e la mostra
      card.classList.add("flip");

      if (!firstCard) {
        firstCard = card;
        return;
      }

      // seconda carta cliccata
      secondCard = card;
      lockBoard = true;

      // confronto
      if (firstCard.dataset.image === secondCard.dataset.image) {
        // MATCH: rimangono girate
        firstCard.dataset.matched = "true";
        secondCard.dataset.matched = "true";
        matches++;
        resetBoard();
        if (matches === totalMatches) {
          setTimeout(() => alert("Bravissimo amore mio bello. Sei riuscito a finire il memory."), 200);
          startFireworks();
        }
      } else {
        // NO MATCH: dopo 1 secondo si rigirano entrambe
        setTimeout(() => {
          firstCard.classList.remove("flip");
          secondCard.classList.remove("flip");
          resetBoard();
        }, 1000);
      }
    });

    grid.appendChild(card);
  });

  return wrapper;
}
// -------------------- PUZZLE GAME --------------------
function createPuzzleGame(item) {
  const rows = item.rows;
  const cols = item.cols;
  const pieceSize = item.pieceSize || 100;
  const gap = 20; // distanza tra griglia posizionamento e griglia partenza

  // wrapper principale
  const wrapper = document.createElement("div");
  wrapper.className = "puzzle-wrapper";
  wrapper.style.width = `${cols * pieceSize + 20}px`;
  wrapper.style.margin = "30px auto";
  wrapper.style.border = "2px solid #ddd";
  wrapper.style.padding = "12px";
  wrapper.style.boxSizing = "border-box";
  wrapper.style.background = "#fff";

  // griglia di posizionamento (solved)
  const solvedContainer = document.createElement("div");
  solvedContainer.className = "puzzle-solved-grid";
  solvedContainer.style.display = "grid";
  solvedContainer.style.gridTemplateColumns = `repeat(${cols}, ${pieceSize}px)`;
  solvedContainer.style.gridAutoRows = `${pieceSize}px`;
  solvedContainer.style.gap = "0px";
  solvedContainer.style.width = `${cols * pieceSize}px`;
  solvedContainer.style.margin = "0 auto";
  solvedContainer.style.boxSizing = "border-box";
  wrapper.appendChild(solvedContainer);

  // celle target
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      const cell = document.createElement("div");
      cell.className = "puzzle-cell";
      cell.style.width = `${pieceSize}px`;
      cell.style.height = `${pieceSize}px`;
      cell.style.border = "1px dashed #bbb";
      cell.style.boxSizing = "border-box";
      cell.dataset.position = `${r}-${c}`;

      cell.addEventListener("dragover", e => e.preventDefault());
      cell.addEventListener("drop", e => {
        e.preventDefault();
        const id = e.dataTransfer.getData("text/plain");
        const piece = document.querySelector(`[data-piece-id="${id}"]`);
        if (!piece) return;
        // se la cella ha gi√† un figlio, manda quel pezzo di nuovo nella startGrid
        if (cell.firstChild && cell.firstChild !== piece) {
          startGrid.appendChild(cell.firstChild);
        }
        cell.appendChild(piece);
        piece.style.position = "relative";
        piece.style.top = "0";
        piece.style.left = "0";
        piece.style.margin = "0";
        finalizePlace(piece, cell);
      });

      solvedContainer.appendChild(cell);
    }
  }

  // griglia di partenza (pezzi disposti orizzontalmente e su pi√π righe se serve)
  const startGrid = document.createElement("div");
  startGrid.className = "puzzle-start-grid";
  startGrid.style.display = "flex";
  startGrid.style.flexWrap = "wrap";
  startGrid.style.justifyContent = "center";
  startGrid.style.gap = "6px";
  startGrid.style.margin = `${gap}px auto 0 auto`;
  startGrid.style.width = `${cols * pieceSize}px`;
  startGrid.style.boxSizing = "border-box";
  startGrid.style.minHeight = `${pieceSize}px`;
  wrapper.appendChild(startGrid);

  startGrid.addEventListener("dragover", e => e.preventDefault());
  startGrid.addEventListener("drop", e => {
    e.preventDefault();
    const id = e.dataTransfer.getData("text/plain");
    const piece = document.querySelector(`[data-piece-id="${id}"]`);
    if (!piece) return;
    // se la piece era in una cella, rimuovila dalla cella e mettila in startGrid
    startGrid.appendChild(piece);
    piece.style.position = "relative";
    piece.style.margin = "0";
    piece.style.top = "0";
    piece.style.left = "0";
    piece.dataset.placed = "false";
    checkPuzzleSolved();
  });

  // carica immagine e crea pezzi
  const img = new Image();
  img.src = item.data;

  img.onload = () => {
    const bgWidth = cols * pieceSize;
    const bgHeight = rows * pieceSize;

    // crea array dei pezzi e mescola l'ordine di inserimento nello startGrid
    const piecesList = [];
    let idCounter = 0;
    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        const piece = document.createElement("div");
        piece.className = "puzzle-piece";
        piece.style.width = `${pieceSize}px`;
        piece.style.height = `${pieceSize}px`;
        piece.style.backgroundImage = `url(${img.src})`;
        piece.style.backgroundSize = `${bgWidth}px ${bgHeight}px`;
        piece.style.backgroundPosition = `-${c * pieceSize}px -${r * pieceSize}px`;
        piece.style.border = "1px solid #aaa";
        piece.style.cursor = "grab";
        piece.style.boxSizing = "border-box";
        piece.draggable = true;
        piece.dataset.correct = `${r}-${c}`;
        piece.dataset.pieceId = `p${idCounter}`;
        piece.setAttribute("data-piece-id", `p${idCounter}`);

        // drag events
        piece.addEventListener("dragstart", (e) => {
          e.dataTransfer.setData("text/plain", piece.dataset.pieceId);
          // hack per consentire drop su Firefox: set drag image
          if (e.dataTransfer.setDragImage) {
            const crt = piece.cloneNode(true);
            crt.style.position = "absolute";
            crt.style.top = "-9999px";
            crt.style.left = "-9999px";
            crt.style.width = piece.style.width;
            document.body.appendChild(crt);
            e.dataTransfer.setDragImage(crt, 10, 10);
            setTimeout(()=> document.body.removeChild(crt),0);
          }
        });

        piece.addEventListener("dragend", () => {
          // nothing special
        });

        piecesList.push(piece);
        idCounter++;
      }
    }

    // mescola e aggiungi allo startGrid
    for (let i = piecesList.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [piecesList[i], piecesList[j]] = [piecesList[j], piecesList[i]];
    }
    piecesList.forEach(p => startGrid.appendChild(p));
  };

  function finalizePlace(piece, cell) {
    if (piece.dataset.correct === cell.dataset.position) {
      piece.dataset.placed = "true";
    } else {
      piece.dataset.placed = "false";
    }
    checkPuzzleSolved();
  }

  function checkPuzzleSolved() {
    const cells = solvedContainer.querySelectorAll(".puzzle-cell");
    for (let cell of cells) {
      if (!cell.firstChild) return false;
      if (cell.firstChild.dataset.correct !== cell.dataset.position) return false;
    }
    // se arriviamo qui, √® risolto
    if (!wrapper.querySelector(".puzzle-completed")) {
      const msg = document.createElement("div");
      msg.className = "puzzle-completed";
      msg.style.marginTop = "20px";
      msg.style.color = "green";
      msg.style.fontSize = "1.3rem";
      msg.style.fontWeight = "bold";
      msg.style.textAlign = "center";
      msg.textContent = " Bravissimo amore mioooo. Sei riuscito a finire il puzzle. Ti amooo";
      wrapper.appendChild(msg);
      startFireworks();
    }
    return true;
  }

  return wrapper;
}

// ------------------ GIOCO DI TROVARE LE PAROLE ---------------
function createWordSearch({
  words = [],
  message = "Bravissimo amore mio, sei riuscito a trovare tutte le parole. Ti amo",
  gridSize = 10
}) {
  // Converti in maiuscolo
  words = words.map(w => w.toUpperCase());

  // ----- CONTAINER PRINCIPALE -----
  const container = document.createElement("div");
  container.className = "wordsearch-container";
  container.style.display = "flex";
  container.style.flexDirection = "column";
  container.style.alignItems = "center";
  container.style.gap = "20px";

  // ----- PANNELLO PAROLE -----
  const wordsPanel = document.createElement("div");
  wordsPanel.className = "wordsearch-panel";
  wordsPanel.style.display = "flex";
  wordsPanel.style.gap = "10px";
  wordsPanel.style.flexWrap = "wrap";
  wordsPanel.style.maxWidth = "300px";
  wordsPanel.style.justifyContent = "center";

  const wordStatus = {}; // parola ‚Üí celle corrette trovate

  words.forEach(w => {
    wordStatus[w] = 0;

    const wEl = document.createElement("div");
    wEl.textContent = w;
    wEl.className = "wordsearch-word";
    wEl.style.padding = "5px 10px";
    wEl.style.borderRadius = "8px";
    wEl.style.background = "#eee";
    wEl.style.fontWeight = "bold";

    wordsPanel.appendChild(wEl);
  });

  container.appendChild(wordsPanel);

  // ----- CREA GRIGLIA -----
  let grid = Array.from({ length: gridSize }, () =>
    Array.from({ length: gridSize }, () => "")
  );

  // Celle corrette (tutte le lettere delle parole)
  let correctCells = new Set();

  // Direzioni: ‚Üí ‚Üì ‚Üò
  const directions = [
    { dr: 0, dc: 1 },
    { dr: 1, dc: 0 },
    { dr: 1, dc: 1 }
  ];

  // Posiziona una parola nella griglia
  function placeWord(word) {
    const len = word.length;
    let placed = false;

    while (!placed) {
      const { dr, dc } = directions[Math.floor(Math.random() * directions.length)];

      const maxR = dr === 0 ? gridSize : gridSize - len;
      const maxC = dc === 0 ? gridSize : gridSize - len;

      const row = Math.floor(Math.random() * maxR);
      const col = Math.floor(Math.random() * maxC);

      // Posiziona le lettere
      for (let i = 0; i < len; i++) {
        const r = row + dr * i;
        const c = col + dc * i;
        grid[r][c] = word[i];
        correctCells.add(`${r}-${c}`);  
      }

      placed = true;
    }
  }

  // Metti tutte le parole
  words.forEach(placeWord);

  // Riempi le celle vuote
  for (let r = 0; r < gridSize; r++) {
    for (let c = 0; c < gridSize; c++) {
      if (grid[r][c] === "") {
        grid[r][c] = String.fromCharCode(65 + Math.floor(Math.random() * 26));
      }
    }
  }

  // ----- CREA GRIGLIA HTML -----
  const gridEl = document.createElement("div");
  gridEl.className = "wordsearch-grid";
  gridEl.style.display = "grid";
  gridEl.style.gridTemplateColumns = `repeat(${gridSize}, 40px)`;
  gridEl.style.gap = "3px";

  let foundCorrectCells = new Set();

  // click sulle celle
  function handleClick(cellEl, r, c) {
    const id = `${r}-${c}`;

    if (cellEl.classList.contains("selected")) {
      // toggle: torna bianco
      cellEl.classList.remove("selected");
      cellEl.style.background = "white";

      if (foundCorrectCells.has(id)) {
        foundCorrectCells.delete(id);

        // aggiorna parole completate
        words.forEach(w => wordStatus[w] = 0);

        // ricontrolla tutte le celle corrette selezionate
        foundCorrectCells.forEach(pos => {
          const [rr, cc] = pos.split("-").map(Number);
          const letter = grid[rr][cc];

          words.forEach(w => {
            if (w.includes(letter)) wordStatus[w]++;
          });
        });
      }

      return;
    }

    // selezione nuova
    cellEl.classList.add("selected");

    if (correctCells.has(id)) {
      cellEl.style.background = "lightgreen";
      foundCorrectCells.add(id);
    } else {
      cellEl.style.background = "salmon";
    }

    // aggiorna parole completate
    words.forEach(w => {
      const letters = w.split("");
      const required = letters.length;

      let count = 0;
      for (let r = 0; r < gridSize; r++) {
        for (let c = 0; c < gridSize; c++) {
          if (letters.includes(grid[r][c]) && foundCorrectCells.has(`${r}-${c}`)) {
            count++;
          }
        }
      }

      wordStatus[w] = count;

      // colora parola trovata
      const el = [...wordsPanel.children].find(x => x.textContent === w);
      if (count === required) {
        el.style.background = "lightgreen";
      } else {
        el.style.background = "#eee";
      }
    });

    // controllo finale
    if ([...correctCells].every(x => foundCorrectCells.has(x))) {
      const msg = document.createElement("div");
      msg.textContent = message;
      msg.style.fontSize = "20px";
      msg.style.fontWeight = "bold";
      msg.style.marginTop = "20px";
      msg.style.color = "#2b7a0b";
      container.appendChild(msg);
    }
  }

  // CREA CELLE
  for (let r = 0; r < gridSize; r++) {
    for (let c = 0; c < gridSize; c++) {
      const cell = document.createElement("div");

      cell.textContent = grid[r][c];
      cell.style.width = "40px";
      cell.style.height = "40px";
      cell.style.display = "flex";
      cell.style.alignItems = "center";
      cell.style.justifyContent = "center";
      cell.style.border = "1px solid #ccc";
      cell.style.cursor = "pointer";
      cell.style.fontWeight = "bold";
      cell.style.userSelect = "none";
      cell.style.background = "white";

      cell.addEventListener("click", () => handleClick(cell, r, c));

      gridEl.appendChild(cell);
    }
  }

  container.appendChild(gridEl);
  return container;
}
// ------------- SLOT MACHINE -------------------
function initSlotMachine() {
  const container = document.getElementById("slot-machine-container");
  if (!container) return;

  container.innerHTML = `
  <div class="slot-machine" style="display:flex; justify-content:center; align-items:flex-start; gap:20px;">
      <!-- Colonna punteggi -->
      <div class="slot-values" style="display:flex; flex-direction:column; gap:10px; font-size:18px; font-weight:bold; text-align:left;">
          <p>üíï   300 punti</p>
          <p>ü©µ   200 punti</p>
          <p>‚≠ê   150 punti</p>
          <p>üå≤   100 punti</p>
          <p>2 coppie uguali   80 punti</p>
          <p>1 coppia   30 punti</p>
      </div>

      <!-- Colonna slot -->
      <div style="display:flex; flex-direction:column; align-items:center;">
          <div id="topScore" style="font-size:28px; font-weight:bold; margin-bottom:15px;">Punteggio: 0</div>

          <div class="slots" style="display:flex; gap:10px; overflow:hidden; height:80px;">
              <div class="reel" id="reel1" style="font-size:60px; width:80px; height:80px; line-height:80px; border:2px solid #444; border-radius:10px; background:#fff; display:flex; align-items:center; justify-content:center;"></div>
              <div class="reel" id="reel2" style="font-size:60px; width:80px; height:80px; line-height:80px; border:2px solid #444; border-radius:10px; background:#fff; display:flex; align-items:center; justify-content:center;"></div>
              <div class="reel" id="reel3" style="font-size:60px; width:80px; height:80px; line-height:80px; border:2px solid #444; border-radius:10px; background:#fff; display:flex; align-items:center; justify-content:center;"></div>
              <div class="reel" id="reel4" style="font-size:60px; width:80px; height:80px; line-height:80px; border:2px solid #444; border-radius:10px; background:#fff; display:flex; align-items:center; justify-content:center;"></div>
          </div>

          <!-- Leva -->
          <div id="lever" style="width:30px; height:120px; background:#c0392b; border-radius:15px; margin-top:20px; cursor:pointer; position:relative;">
              <div style="position:absolute; bottom:0; width:50px; height:20px; background:#7f8c8d; left:-10px; border-radius:5px;"></div>
          </div>

          <div id="slotMessage" style="margin-top:15px; font-size:18px; font-weight:bold;"></div>
      </div>
  </div>
  `;

  const symbols = ["ü©µ", "üå≤", "‚≠ê", "üíï"];
  const symbolValues = { "üíï": 300, "ü©µ": 200, "‚≠ê": 150, "üå≤": 100 };

  const reels = [
      document.getElementById("reel1"),
      document.getElementById("reel2"),
      document.getElementById("reel3"),
      document.getElementById("reel4")
  ];

  const lever = document.getElementById("lever");
  const topScoreDisplay = document.getElementById("topScore");
  const msg = document.getElementById("slotMessage");

  let score = 0;
  topScoreDisplay.textContent = "Punteggio: " + score;

  lever.addEventListener("click", () => {
      // animazione leva realistica
      lever.style.transform = "rotate(25deg)";
      setTimeout(() => lever.style.transform = "rotate(0deg)", 200);

      msg.textContent = "";
      spinReels();
  });

  function spinReels() {
      const finalSymbols = [];
      let finished = 0;

      reels.forEach((reel, idx) => {
          const reelSymbols = [];
          for (let i = 0; i < 20; i++) {
              reelSymbols.push(symbols[Math.floor(Math.random() * symbols.length)]);
          }
          let position = 0;
          const speed = 10 + idx * 5;
          const stopIndex = Math.floor(Math.random() * symbols.length);

          const interval = setInterval(() => {
              reel.textContent = reelSymbols[position % reelSymbols.length];
              position++;
              if (position >= reelSymbols.length + stopIndex + 10) {
                  clearInterval(interval);
                  const finalSymbol = reelSymbols[(position - 1) % reelSymbols.length];
                  reel.textContent = finalSymbol;
                  finalSymbols[idx] = finalSymbol;
                  finished++;
                  if (finished === reels.length) checkWin(finalSymbols);
              }
          }, speed);
      });
  }

  function checkWin(results) {
      let win = 0;
      const counts = {};
      results.forEach(s => counts[s] = (counts[s] || 0) + 1);
      const values = Object.values(counts);
      let roundMsg = "";

      if (values.includes(4)) {
          const symbol = Object.keys(counts).find(k => counts[k] === 4);
          win += symbolValues[symbol];
          roundMsg = `Quattro ${symbol}! Hai vinto ${symbolValues[symbol]} punti amore!`;
      } else if (values.filter(v => v === 2).length === 2) {
          win += 80;
          roundMsg = " Due coppie! Hai vinto 80 punti amore mio!";
      } else if (values.includes(2)) {
          win += 30;
          roundMsg = "Una coppia! Hai vinto 30 punti amore. bravissimo!";
      }

      score += win;
      topScoreDisplay.textContent = "Punteggio: " + score;

      if (score >= 400) {
          msg.textContent = "Bravissimo amore mio, hai raggiunto i 400 punti...";
          startFireworks();
          score = 0;
          topScoreDisplay.textContent = "Punteggio: " + score;
      } else {
          msg.textContent = roundMsg;
      }
  }
}
document.addEventListener("DOMContentLoaded", initSlotMachine);
// --------------------GRATTA E VINCI -----------------
function createScratchCard(item) {
  const container = document.createElement("div");
  container.className = "scratchcard-container";
  container.style.position = "relative";
  container.style.width = "700px";
  container.style.height = "750px";
  container.style.margin = "20px auto";

  const canvas = document.createElement("canvas");
  canvas.width = 700;
  canvas.height = 750;
  container.appendChild(canvas);
  const ctx = canvas.getContext("2d");

  const texts = item.texts || ["Coccole (sai quali)","maschere insieme","Ti faccio un massaggio","dobbiamo inventare un saluto segreto","sfida del mimo","ritratto a vicenda","balletto di TikTok","iniziare a scrivere la lista cartacea","fare un puzzle"];
  const circles = [];
  const radius = 90; // grandi
  const marginX = 40;
  const marginY = 50;

  // posizioni cerchi: 3 file x 3 colonne
  for (let row = 0; row < 3; row++) {
      for (let col = 0; col < 3; col++) {
          const x = marginX + radius + col * (2 * radius + marginX);
          const y = marginY + radius + row * (2 * radius + marginY);
          circles.push({ x, y, r: radius, scratched: false, text: texts[row*3 + col] });
      }
  }

  function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // testo sotto
      circles.forEach(c => {
          ctx.fillStyle = "white";
          ctx.font = "30px Arial";
          ctx.textAlign = "center";
          ctx.textBaseline = "middle";
          ctx.fillText(c.text, c.x, c.y);
      });

      // patina rossa brillantinata sopra i cerchi
      circles.forEach(c => {
          ctx.fillStyle = "red";
          ctx.beginPath();
          ctx.arc(c.x, c.y, c.r, 0, Math.PI*2);
          ctx.fill();

          // brillantini
          for (let i = 0; i < 100; i++) {
              ctx.fillStyle = "white";
              const angle = Math.random() * Math.PI*2;
              const r = Math.random() * c.r;
              ctx.beginPath();
              ctx.arc(c.x + r * Math.cos(angle), c.y + r * Math.sin(angle), 2, 0, Math.PI*2);
              ctx.fill();
          }
      });
  }

  draw();

  let scratching = false;
  let scratchedCount = 0;
  const maxScratches = 3;

  function getMousePos(e) {
      const rect = canvas.getBoundingClientRect();
      return { x: e.clientX - rect.left, y: e.clientY - rect.top };
  }

  function startScratch(e) {
      scratching = true;
      scratch(e);
  }
  function stopScratch() { scratching = false; }

  function scratch(e) {
      if (!scratching) return;
      if (scratchedCount >= maxScratches) return;

      const pos = getMousePos(e);
      circles.forEach(c => {
          const dist = Math.hypot(pos.x - c.x, pos.y - c.y);
          if (dist <= c.r && !c.scratched) {
              ctx.save();
              ctx.globalCompositeOperation = 'destination-out';
              ctx.beginPath();
              ctx.arc(pos.x, pos.y, 25, 0, Math.PI*2);
              ctx.fill();
              ctx.restore();
          }
      });
  }

  canvas.addEventListener("mousedown", startScratch);
  canvas.addEventListener("mousemove", scratch);
  canvas.addEventListener("mouseup", stopScratch);
  canvas.addEventListener("mouseleave", stopScratch);

  // supporto touch
  canvas.addEventListener("touchstart", (e)=>{ e.preventDefault(); startScratch(e.touches[0]); });
  canvas.addEventListener("touchmove", (e)=>{ e.preventDefault(); scratch(e.touches[0]); });
  canvas.addEventListener("touchend", stopScratch);

  return container;
}
// -------------------- ALBERO DI NATALE INTERATTIVO --------------------
    function createChristmasTreeGame(item) {
      const wrapper = document.createElement("div");
      wrapper.style.display = "flex";
      wrapper.style.justifyContent = "center";
      wrapper.style.alignItems = "flex-start";
      wrapper.style.gap = "30px";
      wrapper.style.flexWrap = "wrap";
  
      // CONTAINER ALBERO (relativo!)
      const treeContainer = document.createElement("div");
      treeContainer.style.position = "relative";
      treeContainer.style.width = "400px"; // dimensione albero
      treeContainer.style.height = "auto";
      wrapper.appendChild(treeContainer);
  
      // ALBERO
      const tree = document.createElement("img");
      tree.src = item.treeImage; 
      tree.style.width = "100%";
      tree.style.height = "auto";
      tree.style.userSelect = "none";
      treeContainer.appendChild(tree);
  
      // CONTAINER DECORAZIONI (palline + fiocchi)
      const decorationsContainer = document.createElement("div");
      decorationsContainer.style.display = "flex";
      decorationsContainer.style.flexDirection = "column";
      decorationsContainer.style.gap = "10px";
      wrapper.appendChild(decorationsContainer);
  
      let placedCount = 0;
      const totalDecorations = item.balls.length + (item.bows ? item.bows.length : 0);
  
      // PALLINE CON IMMAGINI
      item.balls.forEach(imgSrc => {
          const ball = document.createElement("div");
          ball.style.width = "45px";
          ball.style.height = "45px";
          ball.style.borderRadius = "50%";
          ball.style.display = "flex";
          ball.style.alignItems = "center";
          ball.style.justifyContent = "center";
          ball.style.cursor = "grab";
          ball.draggable = true;
          ball.dataset.type = "ball";
          ball.dataset.placed = "false";
  
          const img = document.createElement("img");
          img.src = imgSrc;
          img.style.width = "100%";
          img.style.height = "100%";
          img.style.borderRadius = "50%";
          img.style.objectFit = "cover";
          ball.appendChild(img);
  
          decorationsContainer.appendChild(ball);
      });
  
      // FIOCCHI (senza bordo)
      if (item.bowContent) {
        item.bowContent.forEach(bowContent => {
            const bow = document.createElement("div");
            bow.textContent = bowContent;
            bow.style.width = "45px";
            bow.style.height = "45px";
            bow.style.display = "flex";
            bow.style.alignItems = "center";
            bow.style.justifyContent = "center";
            bow.style.cursor = "grab";
            bow.style.fontSize = "24px";
            bow.draggable = true;
            bow.dataset.type = "bow";
            bow.dataset.placed = "false";
            decorationsContainer.appendChild(bow);
        });
    }
  
      // DROP SULL'ALBERO
      tree.addEventListener("dragover", e => e.preventDefault());
      tree.addEventListener("drop", e => {
          e.preventDefault();
          const elem = document.querySelector(`[draggable][data-placed='false']`);
          if (!elem) return;
  
          const rect = treeContainer.getBoundingClientRect();
          const x = e.clientX - rect.left - elem.offsetWidth/2;
          const y = e.clientY - rect.top - elem.offsetHeight/2;
  
          elem.style.position = "absolute";
          elem.style.left = `${x}px`;
          elem.style.top = `${y}px`;
          elem.dataset.placed = "true";
  
          treeContainer.appendChild(elem); 
  
          placedCount++;
          if (placedCount === totalDecorations) {
              startConfetti(wrapper);
              const msg = document.createElement("div");
              msg.textContent = item.message;
              msg.style.fontSize = "24px";
              msg.style.fontWeight = "bold";
              msg.style.color = "#2b7a0b";
              msg.style.textAlign = "center";
              msg.style.marginTop = "20px";
              wrapper.appendChild(msg);
          }
      });
  
      return wrapper;
  }
  // CORIANDOLI PASTELLO
  function startConfetti(wrapper) {
      const colors = ["#f9c1c1","#f9e1c1","#f9f3c1","#c1f9c9","#c1f0f9","#e6c1f9"];
      for (let i = 0; i < 300; i++) { // tanti coriandoli
          const conf = document.createElement("div");
          conf.style.width = conf.style.height = "8px";
          conf.style.borderRadius = "50%";
          conf.style.background = colors[Math.floor(Math.random() * colors.length)];
          conf.style.position = "absolute";
          conf.style.left = Math.random() * window.innerWidth + "px";
          conf.style.top = "-20px";
          conf.style.opacity = 0.8;
          conf.style.pointerEvents = "none";
          wrapper.appendChild(conf);
  
          const duration = 2000 + Math.random()*2000;
          setTimeout(() => {
              conf.animate([
                  { transform: `translateY(0px)` },
                  { transform: `translateY(${window.innerHeight}px)` }
              ], { duration: duration, easing: "linear" });
          }, Math.random()*1000); // sfasamento
      }
  }
//------------------ TROVA LE DIFFERENZE--------------------------
function createFindTheDifferences(item) {

  // --- CONFIG ---
  const imgSrc1 = item.img1;  // prima immagine
  const imgSrc2 = item.img2;  // seconda immagine
  const differences = item.differences; // lista differenze {x,y,r}

  let found = new Array(differences.length).fill(false);

  // --- WRAPPER ---
  const root = document.createElement("div");
  root.style.display = "flex";
  root.style.flexDirection = "column";
  root.style.alignItems = "center";
  root.style.gap = "12px";
  root.style.marginTop = "10px";

  // --- TITLE ---
  const title = document.createElement("h2");
  title.textContent = "Trova le differenze!";
  title.style.textAlign = "center";
  title.style.margin = "0";
  root.appendChild(title);

  // --- BOX IMMAGINI ---
  const box = document.createElement("div");
  box.style.display = "flex";
  box.style.gap = "10px";
  root.appendChild(box);

  // CANVAS SX
  const canvas1 = document.createElement("canvas");
  const ctx1 = canvas1.getContext("2d");
  box.appendChild(canvas1);

  // CANVAS DX
  const canvas2 = document.createElement("canvas");
  const ctx2 = canvas2.getContext("2d");
  box.appendChild(canvas2);

  // IMMAGINI
  const img1 = new Image();
  const img2 = new Image();
  img1.src = imgSrc1;
  img2.src = imgSrc2;

  // --- LOADING ---
  Promise.all([
      new Promise(res => img1.onload = res),
      new Promise(res => img2.onload = res)
  ]).then(() => {

      canvas1.width = img1.width;
      canvas1.height = img1.height;
      canvas2.width = img2.width;
      canvas2.height = img2.height;

      ctx1.drawImage(img1, 0, 0);
      ctx2.drawImage(img2, 0, 0);
  });

  // --- PALLINI ---
  const dots = document.createElement("div");
  dots.style.display = "flex";
  dots.style.gap = "10px";
  dots.style.marginTop = "10px";
  root.appendChild(dots);

  const dotElements = differences.map(() => {
      const d = document.createElement("div");
      d.style.width = "14px";
      d.style.height = "14px";
      d.style.border = "2px solid #444";
      d.style.borderRadius = "50%";
      d.style.background = "white";
      dots.appendChild(d);
      return d;
  });

  // --- CLICK CHECK ---
  function onClick(ev, canvas, ctx) {
      const rect = canvas.getBoundingClientRect();
      const x = ev.clientX - rect.left;
      const y = ev.clientY - rect.top;

      differences.forEach((diff, i) => {
          if (found[i]) return;
          const dist = Math.sqrt((x - diff.x)**2 + (y - diff.y)**2);
          if (dist < diff.r) {

              found[i] = true;

              // Cerchio rosso
              ctx.beginPath();
              ctx.strokeStyle = "#1e90ff";
              ctx.lineWidth = 3;
              ctx.arc(diff.x, diff.y, diff.r, 0, Math.PI*2);
              ctx.stroke();

              dotElements[i].style.background = "orange";

              // Se tutte trovate ‚Üí coriandoli
              if (found.every(f => f)) {
                  confetti({
                      particleCount: 200,
                      spread: 70,
                      origin: { y: 0.2 }
                  });
              }
          }
      });
  }

  canvas1.addEventListener("click", (e) => onClick(e, canvas1, ctx1));
  canvas2.addEventListener("click", (e) => onClick(e, canvas2, ctx2));

  return root;
}
// ------------------ CONNECT THE DOTS ------------------
function createConnectTheDotsGame(item) {
  const wrapper = document.createElement("div");
  wrapper.style.position = "relative";
  wrapper.style.width = "100%";
  wrapper.style.maxWidth = "900px";
  wrapper.style.margin = "20px auto";

  const canvas = document.createElement("canvas");
  canvas.width = 1550;
  canvas.height = 1200;
  canvas.style.width = "100%";
  canvas.style.height = "auto";
  wrapper.appendChild(canvas);

  const ctx = canvas.getContext("2d");

  const points = [
    { x: 11.7, y: 24.4 }, { x: 54, y: 105 }, { x: 93.5, y: 237.4 },
    { x: 97.2, y: 525.3 }, { x: 233.7, y: 570.1 }, { x: 364.5, y: 568.2 },
    { x: 510.3, y: 512.2 }, { x: 573.9, y: 400.0 }, { x: 637.4, y: 415.0 },
    { x: 658.0, y: 53.3 }, { x: 609.4, y: 570.1 }, { x: 586.9, y: 622.5 },
    { x: 564.5, y: 766.4 }, { x: 355.2, y: 734.6 }, { x: 248.6, y: 764.5 },
    { x: 250.5, y: 904.7 }, { x: 235.5, y: 1059.9 }, { x: 362.6, y: 1056.1 },
    { x: 418.7, y: 972.0 }, { x: 388.8, y: 1061.7 }, { x: 437.4, y: 1069.2 },
    { x: 495.3, y: 953.3 }, { x: 538.3, y: 951.4 }, { x: 543.9, y: 992.6 },
    { x: 472.9, y: 1056.1 }, { x: 572.0, y: 1024.3 }, { x: 585.1, y: 1059.9 },
    { x: 648.6, y: 1059.9 }, { x: 826.2, y: 678.5 }, { x: 785.1, y: 529.0 },
    { x: 781.3, y: 448.6 }, { x: 818.7, y: 400.0 }, { x: 801.9, y: 274.8 },
    { x: 693.5, y: 267.3 }, { x: 637.4, y: 327.1 }, { x: 626.2, y: 396.3 }
  ];

  const radius = 12;
  let current = 0;

  const img = new Image();
  img.src = item.data;
  let imgOpacity = 0;
  let showImage = false; // controllo per mostrare l'immagine solo dopo tutti i punti

  function draw() {
      // cancella solo lo sfondo (rimane trasparente)
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // se l'immagine deve essere mostrata, la disegno prima dei punti
      if (showImage) {
          ctx.globalAlpha = imgOpacity;
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
          ctx.globalAlpha = 1;
      }

      // disegna linee gi√† collegate
      ctx.strokeStyle = "black";
      ctx.lineWidth = 2;
      ctx.beginPath();
      for (let i = 0; i < current; i++) {
          if (i === 0) ctx.moveTo(points[i].x, points[i].y);
          else ctx.lineTo(points[i].x, points[i].y);
      }
      ctx.stroke();

      // disegna punti e numeri sopra l'immagine
      for (let i = 0; i < points.length; i++) {
          ctx.fillStyle = "black";
          ctx.beginPath();
          ctx.arc(points[i].x, points[i].y, radius, 0, Math.PI*2);
          ctx.fill();

          ctx.fillStyle = "black";
          ctx.font = "20px Palatino";
          ctx.fillText(i + 1, points[i].x + radius + 5, points[i].y - radius - 5);
      }
  }

  function drawImageGradually() {
      if (imgOpacity < 1) {
          imgOpacity += 0.02;
          showImage = true;
          draw(); // ridisegna ogni frame con i punti sopra
          requestAnimationFrame(drawImageGradually);
      }
  }

  draw(); // mostra i punti subito

  canvas.addEventListener("click", (e) => {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const clickX = (e.clientX - rect.left) * scaleX;
      const clickY = (e.clientY - rect.top) * scaleY;

      const point = points[current];
      const dx = clickX - point.x;
      const dy = clickY - point.y;
      if (Math.sqrt(dx*dx + dy*dy) <= radius + 5) {
          current++;
          draw();
          if (current === points.length) drawImageGradually(), startFireworks();
      }
  });

  return wrapper;
}
// -------------- CRUCIVERBA ---------------------
function createMiniCrossword(item) {
  const wrapper = document.createElement("div");
  wrapper.style.display = "flex";
  wrapper.style.flexDirection = "column";
  wrapper.style.alignItems = "center";
  wrapper.style.margin = "20px";

  const words = [
      { word: "PAPERA", definition: "Il mio animale preferito (indizio: dobbiamo averlo in casa)" },
      { word: "LOURDES", definition: "Secondo posto che abbiamo visitato insieme" },
      { word: "CIOCCIOTTELLO", definition: "scrivilo in... (indizio:secondo il nostro linguaggio" },
      { word: "CROCIERA", definition: "per alcuni √® una vacanza ma per noi si usa in uno sport..." },
      { word: "TUBO", definition: "tubitolo" },
      { word: "TUTEPATENJA", definition: "Mi fai stare benissimo nel nostro linguaggio" },
      { word: "BERE", definition: " mers" },
      { word: "TULIPANO", definition: "esiste di tanti colori ma quello che ho avuto io era giallo..." },
      { word: "PATAYA", definition: "patata + papaya" },
      { word: "TIAMO", definition: "due paroline che ci diciamo spesso (non mettere lo spazio)" }
  ];

  const grid = document.createElement("div");
  grid.style.display = "grid";
  grid.style.gridTemplateColumns = `repeat(${Math.max(...words.map(w => w.word.length))}, 40px)`;
  grid.style.gridGap = "2px";
  grid.style.marginBottom = "20px";

  const inputs = [];

  words.forEach((w, row) => {
      const rowInputs = [];
      for (let i = 0; i < Math.max(...words.map(w => w.word.length)); i++) {
          const input = document.createElement("input");
          input.maxLength = 1;
          input.style.width = "38px";
          input.style.height = "38px";
          input.style.textAlign = "center";
          input.style.fontSize = "20px";
          input.style.textTransform = "uppercase";
          input.style.border = "1px solid #333";
          input.style.outline = "none";
          input.style.backgroundColor = i < w.word.length ? "white" : "black";

          input.addEventListener("input", () => {
              // Auto-spostamento al prossimo riquadro
              if (i < rowInputs.length - 1 && input.value) {
                  rowInputs[i + 1].focus();
              }
              checkWord(row);
          });

          grid.appendChild(input);
          rowInputs.push(input);
      }
      inputs.push(rowInputs);
  });

  wrapper.appendChild(grid);

  // Definizioni
  const defs = document.createElement("div");
  defs.style.marginTop = "10px";
  defs.style.textAlign = "left";
  defs.style.maxWidth = "600px";
  words.forEach((w, i) => {
      const d = document.createElement("p");
      d.textContent = `${i + 1}) ${w.definition}`;
      defs.appendChild(d);
  });
  wrapper.appendChild(defs);

  // Funzione di controllo
  function checkWord(row) {
      const rowInputs = inputs[row];
      const word = words[row].word.toUpperCase();

      let correct = true;
      rowInputs.forEach((input, i) => {
          if (i >= word.length) return;
          if (input.value.toUpperCase() === word[i]) {
              input.style.backgroundColor = "lightgreen";
          } else if (input.value === "") {
              input.style.backgroundColor = "white";
              correct = false;
          } else {
              input.style.backgroundColor = "salmon";
              correct = false;
          }
      });

      // Verifica se tutte le parole sono completate correttamente
      if (inputs.every((r, idx) => r.slice(0, words[idx].word.length).every((inp, i) => inp.value.toUpperCase() === words[idx].word[i]))) {
          showConfetti();
      }
  }

  // Funzione coriandoli
  function showConfetti() {
    const totalConfetti = 300; // molto pi√π di prima
    for (let i = 0; i < totalConfetti; i++) {
        setTimeout(() => { // effetto a onde, non tutti insieme
            const confetto = document.createElement("div");
            confetto.style.position = "fixed";
            confetto.style.width = "12px";
            confetto.style.height = "12px";
            confetto.style.borderRadius = "50%";
            confetto.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 80%)`;
            confetto.style.top = "-20px";
            confetto.style.left = `${Math.random() * window.innerWidth}px`;
            confetto.style.zIndex = 3000;
            confetto.style.pointerEvents = "none";
            document.body.appendChild(confetto);

            const fallDistance = window.innerHeight + 50 + Math.random() * 200; // scende un po' pi√π lontano
            const fallDuration = 5000 + Math.random() * 3000; // caduta pi√π lenta e variabile

            confetto.animate([
                { transform: `translateY(0px) rotate(0deg)` },
                { transform: `translateY(${fallDistance}px) rotate(${Math.random()*720}deg)` }
            ], {
                duration: fallDuration,
                iterations: 1,
                easing: "linear"
            });

            setTimeout(() => confetto.remove(), fallDuration);
        }, i * 10); // piccola differenza di tempo per l'effetto sparso
    }
}

  return wrapper;
}
//---------------- INDOVINA LA CHAT ---------------
function createChatGuessGame(item) {
  const wrapper = document.createElement("div");
  wrapper.className = "chat-guess-wrapper";

  // immagine della chat (la metti tu nel giorno come item.data)
  const img = document.createElement("img");
  img.src = item.data;
  img.className = "chat-image";
  img.style.width = "70%"
  wrapper.appendChild(img);

  // contenitore risposte
  const answersBox = document.createElement("div");
  answersBox.className = "answers-box";
  wrapper.appendChild(answersBox);

  // opzioni
  const answers = item.answers;     // array di 4 testi
  const correctIndex = item.correct; // numero dell'opzione giusta (0‚Äì3)

  answers.forEach((text, idx) => {
      const btn = document.createElement("div");
      btn.className = "answer-btn";
      btn.textContent = text;

      btn.addEventListener("click", () => {
          // blocca altre scelte
          document.querySelectorAll(".answer-btn").forEach(el => el.style.pointerEvents = "none");

          if (idx === correctIndex) {
              btn.classList.add("correct");
              startFireworks();
          } else {
              btn.classList.add("wrong");
          }
      });

      answersBox.appendChild(btn);
  });

  return wrapper;
}

// -------------------- FUOCHI D'ARTIFICIO REALISTICI --------------------
function startFireworks() {
  if (!fireworksCanvas) {
      fireworksCanvas = document.createElement("canvas");
      fireworksCanvas.id = "fireworksCanvas";
      fireworksCanvas.style.position = "fixed";
      fireworksCanvas.style.top = "0";
      fireworksCanvas.style.left = "0";
      fireworksCanvas.style.width = "100vw";
      fireworksCanvas.style.height = "100vh";
      fireworksCanvas.style.pointerEvents = "none";
      fireworksCanvas.style.zIndex = "9999";
      document.body.appendChild(fireworksCanvas);
  }

  const ctx = fireworksCanvas.getContext("2d");
  fireworksCanvas.width = window.innerWidth;
  fireworksCanvas.height = window.innerHeight;

  const fireworks = [];
  const particles = [];

  class Firework {
      constructor(x, y) {
          this.x = x;
          this.y = window.innerHeight;
          this.targetY = y;
          this.color = `hsl(${Math.random()*360}, 100%, 50%)`;
          this.speed = Math.random() * 5 + 7;
          this.exploded = false;
      }
      update() {
          if (!this.exploded) {
              this.y -= this.speed;
              if (this.y <= this.targetY) {
                  this.explode();
              }
          }
      }
      explode() {
          this.exploded = true;
          for (let i = 0; i < 50; i++) {
              particles.push(new Particle(this.x, this.y, this.color));
          }
      }
      draw() {
          if (!this.exploded) {
              ctx.beginPath();
              ctx.arc(this.x, this.y, 3, 0, Math.PI*2);
              ctx.fillStyle = this.color;
              ctx.fill();
          }
      }
  }

  class Particle {
      constructor(x, y, color) {
          this.x = x;
          this.y = y;
          this.color = color;
          this.speedX = (Math.random() - 0.5) * 8;
          this.speedY = (Math.random() - 0.5) * 8;
          this.alpha = 1;
          this.gravity = 0.05;
      }
      update() {
          this.x += this.speedX;
          this.y += this.speedY;
          this.speedY += this.gravity;
          this.alpha -= 0.02;
      }
      draw() {
          ctx.globalAlpha = this.alpha;
          ctx.beginPath();
          ctx.arc(this.x, this.y, 3, 0, Math.PI*2);
          ctx.fillStyle = this.color;
          ctx.fill();
          ctx.globalAlpha = 1;
      }
  }

  function animate() {
      ctx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);

      if (Math.random() < 0.05) {
          fireworks.push(new Firework(Math.random()*window.innerWidth, Math.random()*window.innerHeight/2));
      }

      fireworks.forEach((f, i) => {
          f.update();
          f.draw();
          if (f.exploded) fireworks.splice(i, 1);
      });

      particles.forEach((p, i) => {
          p.update();
          p.draw();
          if (p.alpha <= 0) particles.splice(i, 1);
      });

      requestAnimationFrame(animate);
  }

  animate();
}
// -------------------- QUIZ --------------------
function checkAnswer(btnElement, selected, correct, quizContainer){
  const buttons = quizContainer.querySelectorAll(".quiz-btn");
  buttons.forEach((b,i)=>{
    b.disabled=true;
    if(i===correct) b.style.background="#228B22";
    else if(i===selected) b.style.background="#B22222";
  });
}

// -------------------- LUCINE NATALIZIE --------------------
const lightsCanvas = document.getElementById("lightsCanvas");
const lctx = lightsCanvas.getContext("2d");
let Lwidth = lightsCanvas.width=window.innerWidth;
let Lheight = lightsCanvas.height=window.innerHeight;
const lights = [], numLights=80;
for(let i=0;i<numLights;i++){
  lights.push({x:Math.random()*Lwidth,y:Math.random()*Lheight,size:Math.random()*3+2,glow:Math.random()*0.6+0.4,blinkSpeed:Math.random()*0.02+0.01,phase:Math.random()*Math.PI*2});
}
function drawLights(){
  lctx.clearRect(0,0,Lwidth,Lheight);
  lights.forEach(light=>{
    light.phase+=light.blinkSpeed;
    let intensity=(Math.sin(light.phase)+1)/2;
    const gradient=lctx.createRadialGradient(light.x,light.y,0,light.x,light.y,light.size*4);
    gradient.addColorStop(0,`rgba(255,230,120,${0.9*intensity})`);
    gradient.addColorStop(0.4,`rgba(255,215,80,${0.5*intensity})`);
    gradient.addColorStop(1,"rgba(255,215,80,0)");
    lctx.beginPath(); lctx.fillStyle=gradient;
    lctx.arc(light.x,light.y,light.size*4,0,Math.PI*2); lctx.fill();
  });
  requestAnimationFrame(drawLights);
}
window.addEventListener("resize",()=>{Lwidth=lightsCanvas.width=window.innerWidth; Lheight=lightsCanvas.height=window.innerHeight;});
drawLights();

// -------------------- PORTA --------------------
function openDoors(){
  const left=document.getElementById('leftDoor');
  const right=document.getElementById('rightDoor');
  const sound=document.getElementById('creakSound');
  if(sound) sound.play();
  if(left) left.classList.add('open-left');
  if(right) right.classList.add('open-right');
  setTimeout(()=>{startSnow();},2000);
}
window.onload=openDoors;

// -------------------- NEVE --------------------
const canvas = document.getElementById("snowCanvas");
const ctx = canvas.getContext("2d");
let width=canvas.width=window.innerWidth;
let height=canvas.height=window.innerHeight;
const snowflakes=[], maxFlakes=150;
for(let i=0;i<maxFlakes;i++){snowflakes.push({x:Math.random()*width,y:Math.random()*-height,radius:Math.random()*4+1,speed:Math.random()*2+1,finished:false});}
let allowSnow=false;
function startSnow(){ allowSnow=true; drawSnow(); }

// -------------------- FUNZIONE PER MOSTRARE IL GIORNO --------------------
function showDay(dayIdx){
  if(dayIdx<0||dayIdx>=contents.length) return;
  currentDay=dayIdx;

  // rimuovo titolo vecchio
  const oldTitle=document.querySelector("#content ~ h3");
  if(oldTitle) oldTitle.remove();

  // pulisco contenuto
  contentEl.innerHTML="";

  // creo titolo nuovo
  const dayTitle=document.createElement("h3");
  dayTitle.textContent=contents[currentDay].day;
  dayTitle.style.opacity=0;
  dayTitle.style.transition="opacity 0.5s";
  dayTitle.style.textAlign="left";
  dayTitle.style.color="rgb(128,0,0)";
  dayTitle.style.fontFamily="Palatino";
  dayTitle.style.fontSize="450%";
  dayTitle.style.marginRight="2%";
  dayTitle.style.marginLeft="40%";
  dayTitle.style.marginTop ="45";
  contentEl.parentElement.insertBefore(dayTitle,contentEl);

  // reset neve
  snowflakes.forEach(f=>{f.y=Math.random()*-height; f.finished=false;});

  let typewriterStarted=false;

  function updateSnowAndTitle(){
    ctx.clearRect(0,0,width,height);
    ctx.fillStyle="white"; ctx.beginPath();
    snowflakes.forEach(flake=>{
      ctx.moveTo(flake.x,flake.y); ctx.arc(flake.x,flake.y,flake.radius,0,Math.PI*2);
      flake.y+=flake.speed;
      if(flake.y>height) flake.finished=true;
    });
    ctx.fill();

    const finishedCount=snowflakes.filter(f=>f.finished).length;
    const progress=Math.min(finishedCount/maxFlakes,1);
    dayTitle.style.opacity=progress;

    if(progress===1 && !typewriterStarted){
      typewriterStarted = true;
    
      // Step 0: rimuovo il titolo vecchio
      dayTitle.style.opacity = 0;
      setTimeout(() => { dayTitle.remove(); }, 500);
    
      // Step 1: creo messaggio del giorno
      const dayMsg = document.createElement("p");
      dayMsg.style.fontSize = "22px";
      dayMsg.style.fontWeight = "bold";
      dayMsg.style.color = "#000000";
      dayMsg.style.textAlign = "center";
      dayMsg.style.marginTop = "30px";
      contentEl.appendChild(dayMsg);
    
      // testo personalizzato per il giorno
      let msgText = contents[currentDay].dayMessage;
      let i = 0;
    
      function typeWriterMsg() {
        if (i < msgText.length) {
          dayMsg.textContent += msgText.charAt(i);
          i++;
          setTimeout(typeWriterMsg, 50); // velocit√† typewriter
        } else {
          // Step 2: rimane 5 secondi
          setTimeout(() => {
            dayMsg.remove();
    
            // Step 3: inserisco i contenuti/giochi del giorno
            contents[currentDay].items.forEach(item => {
    
              if(item.type==="text"){
                const p=document.createElement("p");
                typeWriter(p,item.data,35);
                contentEl.appendChild(p);
              } 
              else if(item.type==="image"){
                const img=document.createElement("img");
                img.src=item.data; img.alt=item.caption||""; img.style.width="250px"; img.style.borderRadius="10px";
                contentEl.appendChild(img);
                if(item.caption){ const cap=document.createElement("p"); cap.textContent=item.caption; contentEl.appendChild(cap);}
              }
              else if(item.type==="memory"){
                const memoryWrapper = createMemoryGame(currentDay);
                contentEl.appendChild(memoryWrapper);
              }
              else if(item.type==="puzzle"){
                const puzzleWrapper = createPuzzleGame({ data:item.data, rows:item.rows||3, cols:item.cols||3 });
                contentEl.appendChild(puzzleWrapper);
              }
              else if(item.type==="wordsearch"){
                const game = createWordSearch({ words:item.words, message:item.message });
                contentEl.appendChild(game);
              }
              else if(item.type==="slotmachine"){
                const slotContainer = document.createElement("div");
                slotContainer.id = "slot-machine-container";
                contentEl.appendChild(slotContainer);
                initSlotMachine();
              }
              else if(item.type==="scratchcard"){
                const scratch = createScratchCard(item);
                contentEl.appendChild(scratch);
              }
              else if(item.type==="christmasTree"){
                contentEl.appendChild(createChristmasTreeGame(item));
              }
              else if(item.type==="diff"){
                const game = createFindTheDifferences(item);
                contentEl.appendChild(game);
              }
              else if(item.type==="connectDots"){
                const game = createConnectTheDotsGame(item);
                contentEl.appendChild(game);
              }
              else if(item.type==="crossword"){
                const crosswordGame = createMiniCrossword(item);
                contentEl.appendChild(crosswordGame);
              }
              else if(item.type==="chatGuess"){
                const game = createChatGuessGame(item);
                contentEl.appendChild(game);
              }
              else if(item.type==="quiz"){
                const quizWrapper=document.createElement("div"); quizWrapper.classList.add("quiz-container");
                const q=document.createElement("p"); q.textContent=item.question; quizWrapper.appendChild(q);
                item.options.forEach((opt,i)=>{
                  const btn=document.createElement("button"); btn.textContent=opt; btn.className="quiz-btn";
                  btn.addEventListener("click",()=>checkAnswer(btn,i,item.correct,quizWrapper));
                  quizWrapper.appendChild(btn); quizWrapper.appendChild(document.createElement("br"));
                });
                contentEl.appendChild(quizWrapper);
              }
    
            });
    
            contentEl.scrollIntoView({behavior:"smooth"});
    
          }, 5000); // fine 5 secondi
        }
      }
    
      typeWriterMsg();
    }

    requestAnimationFrame(updateSnowAndTitle);
  }

  updateSnowAndTitle();
}

// -------------------- PULSANTI NAVIGAZIONE (DEBUG MODE) --------------------
if(debugMode){
  const nav=document.createElement("div"); nav.style.margin="12px 2%";
  const prev=document.createElement("button"); prev.textContent="‚¨Ö Giorno precedente";
  const next=document.createElement("button"); next.textContent="Giorno successivo ‚û°";
  const showAll=document.createElement("button"); showAll.textContent="Mostra tutto";

  nav.appendChild(prev); nav.appendChild(next); nav.appendChild(showAll);
  document.body.insertBefore(nav, contentEl);

  prev.addEventListener("click",()=>{if(currentDay>0) showDay(currentDay-1);});
  next.addEventListener("click",()=>{if(currentDay<contents.length-1) showDay(currentDay+1);});
  showAll.addEventListener("click",()=>{contentEl.innerHTML=""; contents.forEach((c,i)=>{c.items.forEach(item=>{const wrapper=document.createElement("div"); wrapper.textContent=item.type==="text"?item.data:item.type; contentEl.appendChild(wrapper);});});});

  // mostra giorno iniziale
  showDay(currentDay);
} else {
  showDay(diffDays);
}

// -------------------- RESIZE CANVAS --------------------
window.addEventListener("resize",()=>{width=canvas.width=window.innerWidth; height=canvas.height=window.innerHeight; Lwidth=lightsCanvas.width=window.innerWidth; Lheight=lightsCanvas.height=window.innerHeight;});
